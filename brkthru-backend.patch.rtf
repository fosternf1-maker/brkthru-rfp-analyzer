{\rtf1\ansi\ansicpg1252\cocoartf2761
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 diff --git a/package.json b/package.json\
new file mode 100644\
index 0000000..f3b6a5a\
--- /dev/null\
+++ b/package.json\
@@ -0,0 +1,36 @@\
+\{\
+  "name": "brkthru-rfp-backend",\
+  "version": "0.1.0",\
+  "description": "Backend for Brkthru RFP Analyzer (OAuth token exchange & AI proxy)",\
+  "main": "server.js",\
+  "scripts": \{\
+    "start": "node server.js"\
+  \},\
+  "dependencies": \{\
+    "body-parser": "^1.20.2",\
+    "cors": "^2.8.5",\
+    "dotenv": "^16.0.0",\
+    "express": "^4.18.2",\
+    "express-session": "^1.17.3",\
+    "undici": "^5.23.0"\
+  \},\
+  "engines": \{\
+    "node": ">=18"\
+  \}\
+\}\
diff --git a/server.js b/server.js\
new file mode 100644\
index 0000000..b1c9e8d\
--- /dev/null\
+++ b/server.js\
@@ -0,0 +1,360 @@\
+require('dotenv').config();\
+const express = require('express');\
+const session = require('express-session');\
+const bodyParser = require('body-parser');\
+const cors = require('cors');\
+const \{ fetch \} = require('undici');\
+\
+const app = express();\
+const PORT = process.env.PORT || 4000;\
+\
+if (!process.env.GOOGLE_CLIENT_ID || !process.env.GOOGLE_CLIENT_SECRET || !process.env.ANTHROPIC_API_KEY || !process.env.TEMPLATE_ID || !process.env.SESSION_SECRET) \{\
+  console.warn('Missing required environment variables. See .env.example');\
+\}\
+\
+app.use(cors(\{ origin: process.env.FRONTEND_ORIGIN || true, credentials: true \}));\
+app.use(bodyParser.json(\{ limit: '2mb' \}));\
+app.use(session(\{\
+  name: 'brkthru.sid',\
+  secret: process.env.SESSION_SECRET || 'change-me',\
+  resave: false,\
+  saveUninitialized: false,\
+  cookie: \{ httpOnly: true, secure: process.env.NODE_ENV === 'production' \}\
+\}));\
+\
+function nowMs() \{ return Date.now(); \}\
+\
+async function refreshAccessTokenIfNeeded(reqSession) \{\
+  const g = reqSession.google;\
+  if (!g) throw new Error('No google session');\
+  if (g.access_token && g.expiry_ms && g.expiry_ms > nowMs() + 60000) \{\
+    return g.access_token;\
+  \}\
+  if (!g.refresh_token) throw new Error('No refresh token available');\
+\
+  const tokenRes = await fetch('https://oauth2.googleapis.com/token', \{\
+    method: 'POST',\
+    headers: \{ 'Content-Type': 'application/x-www-form-urlencoded' \},\
+    body: new URLSearchParams(\{\
+      client_id: process.env.GOOGLE_CLIENT_ID,\
+      client_secret: process.env.GOOGLE_CLIENT_SECRET,\
+      grant_type: 'refresh_token',\
+      refresh_token: g.refresh_token\
+    \}).toString()\
+  \});\
+\
+  if (!tokenRes.ok) \{\
+    const t = await tokenRes.text();\
+    throw new Error(`Google refresh error: $\{tokenRes.status\} $\{t\}`);\
+  \}\
+\
+  const data = await tokenRes.json();\
+  g.access_token = data.access_token;\
+  g.expiry_ms = nowMs() + (data.expires_in * 1000);\
+  reqSession.google = g;\
+  return g.access_token;\
+\}\
+\
+app.post('/auth/exchange', async (req, res) => \{\
+  try \{\
+    const \{ code, redirectUri \} = req.body;\
+    if (!code || !redirectUri) return res.status(400).json(\{ error: 'code and redirectUri required' \});\
+\
+    const tokenRes = await fetch('https://oauth2.googleapis.com/token', \{\
+      method: 'POST',\
+      headers: \{ 'Content-Type': 'application/x-www-form-urlencoded' \},\
+      body: new URLSearchParams(\{\
+        code,\
+        client_id: process.env.GOOGLE_CLIENT_ID,\
+        client_secret: process.env.GOOGLE_CLIENT_SECRET,\
+        redirect_uri: redirectUri,\
+        grant_type: 'authorization_code'\
+      \}).toString()\
+    \});\
+\
+    if (!tokenRes.ok) \{\
+      const t = await tokenRes.text();\
+      return res.status(500).json(\{ error: 'Token exchange failed', details: t \});\
+    \}\
+\
+    const data = await tokenRes.json();\
+    req.session.google = \{\
+      access_token: data.access_token,\
+      refresh_token: data.refresh_token,\
+      expiry_ms: Date.now() + (data.expires_in * 1000)\
+    \};\
+    return res.json(\{ ok: true \});\
+  \} catch (err) \{\
+    return res.status(500).json(\{ error: err.message \});\
+  \}\
+\});\
+\
+app.get('/auth/status', (req, res) => \{\
+  res.json(\{ authenticated: !!(req.session && req.session.google && req.session.google.access_token) \});\
+\});\
+\
+app.post('/api/ai/analyze', async (req, res) => \{\
+  try \{\
+    const \{ rfp \} = req.body;\
+    if (!rfp) return res.status(400).json(\{ error: 'rfp is required' \});\
+\
+    const systemPrompt = `You are a digital media strategist for Brkthru. Return ONLY valid JSON matching this schema:\
+\{\
+  "clientName": "...",\
+  "strategy": \{ "goals": [...], "targetAudience": "...", "geographicTarget":"...", "recommendedChannels":[...], "narrative":"...", "targetingApproach":"..." \},\
+  "investment": \{ "totalBudget":"...", "flightDates":"...", "mediaAllocation":[\{"channel":"...","percentage":0,"budget":"...","rationale":"...","kpis":"..."\}], "pixelStrategy":"..." \},\
+  "research": \{ "insights":[\{"title":"...","finding":"...","source":"...","relevance":"..."\}] \}\
+\}`;\
+\
+    const anthropicBody = \{\
+      model: process.env.ANTHROPIC_MODEL || 'claude-sonnet-4-20250514',\
+      max_tokens: 4000,\
+      temperature: 0.2,\
+      prompt: `$\{systemPrompt\}\\n\\nRFP:\\n$\{rfp\}\\n\\nReturn JSON only.`\
+    \};\
+\
+    const r = await fetch(process.env.ANTHROPIC_API_URL || 'https://api.anthropic.com/v1/complete', \{\
+      method: 'POST',\
+      headers: \{\
+        'Content-Type': 'application/json',\
+        'x-api-key': process.env.ANTHROPIC_API_KEY\
+      \},\
+      body: JSON.stringify(anthropicBody)\
+    \});\
+\
+    if (!r.ok) \{\
+      const t = await r.text();\
+      return res.status(502).json(\{ error: 'Anthropic API error', details: t \});\
+    \}\
+\
+    const data = await r.json();\
+    const text = data?.completion || data?.text || JSON.stringify(data);\
+    const jsonMatch = String(text).match(/\\\{[\\s\\S]*\\\}/);\
+    if (!jsonMatch) return res.status(500).json(\{ error: 'Failed to parse LLM output', raw: text \});\
+    const parsed = JSON.parse(jsonMatch[0]);\
+    return res.json(\{ analysis: parsed \});\
+  \} catch (err) \{\
+    return res.status(500).json(\{ error: err.message \});\
+  \}\
+\});\
+\
+app.post('/api/slides/create', async (req, res) => \{\
+  try \{\
+    if (!req.session || !req.session.google) return res.status(401).json(\{ error: 'Not authenticated with Google' \});\
+    const \{ content \} = req.body;\
+    if (!content) return res.status(400).json(\{ error: 'content required' \});\
+\
+    const accessToken = await refreshAccessTokenIfNeeded(req.session);\
+\
+    const copyRes = await fetch(`https://www.googleapis.com/drive/v3/files/$\{process.env.TEMPLATE_ID\}/copy`, \{\
+      method: 'POST',\
+      headers: \{ 'Authorization': `Bearer $\{accessToken\}`, 'Content-Type': 'application/json' \},\
+      body: JSON.stringify(\{\
+        name: `$\{content.clientName || 'Client'\} - RFP Proposal - $\{new Date().toLocaleDateString()\}`\
+      \})\
+    \});\
+\
+    if (!copyRes.ok) \{\
+      const t = await copyRes.text();\
+      return res.status(502).json(\{ error: 'Drive copy failed', details: t \});\
+    \}\
+    const newDeck = await copyRes.json();\
+    const newDeckId = newDeck.id;\
+    if (!newDeckId) return res.status(500).json(\{ error: 'No new deck id returned' \});\
+\
+    const createRequests = [\
+      \{ createSlide: \{ insertionIndex: -1, slideLayoutReference: \{ predefinedLayout: 'TITLE_AND_BODY' \} \} \},\
+      \{ createSlide: \{ insertionIndex: -1, slideLayoutReference: \{ predefinedLayout: 'TITLE_AND_BODY' \} \} \},\
+      \{ createSlide: \{ insertionIndex: -1, slideLayoutReference: \{ predefinedLayout: 'TITLE_AND_BODY' \} \} \}\
+    ];\
+    await fetch(`https://slides.googleapis.com/v1/presentations/$\{newDeckId\}:batchUpdate`, \{\
+      method: 'POST',\
+      headers: \{ 'Authorization': `Bearer $\{accessToken\}`, 'Content-Type': 'application/json' \},\
+      body: JSON.stringify(\{ requests: createRequests \})\
+    \});\
+\
+    const presRes = await fetch(`https://slides.googleapis.com/v1/presentations/$\{newDeckId\}`, \{\
+      headers: \{ 'Authorization': `Bearer $\{accessToken\}` \}\
+    \});\
+    const presentation = await presRes.json();\
+    const slides = presentation.slides || [];\
+    const lastSlides = slides.slice(-3);\
+\
+    const textRequests = [];\
+    lastSlides.forEach((slide, idx) => \{\
+      const textBoxes = (slide.pageElements || []).filter(el => el.shape && el.shape.shapeType === 'TEXT_BOX');\
+      if (textBoxes.length >= 2) \{\
+        const title = idx === 0 ? '\uc0\u55357 \u56522  Behind the Strategy' : idx === 1 ? '\u55357 \u56496  Recommended Investment' : '\u55357 \u56589  Market Research & Insights';\
+        let body = '';\
+        if (idx === 0) \{\
+          body = `Goals: $\{(content.strategy?.goals || []).join(', ')\}\\n\\nTarget: $\{content.strategy?.targetAudience\}\\n\\nChannels: $\{(content.strategy?.recommendedChannels || []).join(', ')\}\\n\\n$\{content.strategy?.narrative || ''\}\\n\\n$\{content.strategy?.targetingApproach || ''\}`;\
+        \} else if (idx === 1) \{\
+          body = `Budget: $\{content.investment?.totalBudget\} | $\{content.investment?.flightDates\}\\n\\n` +\
+            ((content.investment?.mediaAllocation || []).map(ch => `$\{ch.channel\} - $\{ch.percentage\}% ($\{ch.budget\})\\n$\{ch.rationale\}\\nKPIs: $\{ch.kpis\}`).join('\\n\\n')) +\
+            `\\n\\nPixel: $\{content.investment?.pixelStrategy || ''\}`;\
+        \} else \{\
+          body = (content.research?.insights || []).map(ins => `$\{ins.title\}\\n$\{ins.finding\}\\nSource: $\{ins.source\}\\nRelevance: $\{ins.relevance\}`).join('\\n\\n');\
+        \}\
+\
+        textRequests.push(\
+          \{ insertText: \{ objectId: textBoxes[0].objectId, text: title, insertionIndex: 0 \} \},\
+          \{ insertText: \{ objectId: textBoxes[1].objectId, text: body, insertionIndex: 0 \} \}\
+        );\
+      \}\
+    \});\
+\
+    if (textRequests.length) \{\
+      await fetch(`https://slides.googleapis.com/v1/presentations/$\{newDeckId\}:batchUpdate`, \{\
+        method: 'POST',\
+        headers: \{ 'Authorization': `Bearer $\{accessToken\}`, 'Content-Type': 'application/json' \},\
+        body: JSON.stringify(\{ requests: textRequests \})\
+      \});\
+    \}\
+\
+    return res.json(\{ url: `https://docs.google.com/presentation/d/$\{newDeckId\}/edit` \});\
+  \} catch (err) \{\
+    return res.status(500).json(\{ error: err.message \});\
+  \}\
+\});\
+\
+app.listen(PORT, () => console.log(`Server running on $\{PORT\}`));\
diff --git a/.env.example b/.env.example\
new file mode 100644\
index 0000000..a7d4b2a\
--- /dev/null\
+++ b/.env.example\
@@ -0,0 +1,16 @@\
+# Google OAuth\
+GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com\
+GOOGLE_CLIENT_SECRET=your-google-client-secret\
+# Template presentation ID (Drive file id)\
+TEMPLATE_ID=1G3YGavHm6fJdCMaLnlRllOlQvisC9Blo\
+\
+# Anthropic\
+ANTHROPIC_API_KEY=sk-...\
+ANTHROPIC_API_URL=https://api.anthropic.com/v1/complete\
+ANTHROPIC_MODEL=claude-sonnet-4-20250514\
+\
+# Session\
+SESSION_SECRET=replace-with-a-secure-random-string\
+\
+# Frontend origin (for CORS)\
+FRONTEND_ORIGIN=http://localhost:3000\
diff --git a/README.md b/README.md\
new file mode 100644\
index 0000000..c2f9f70\
--- /dev/null\
+++ b/README.md\
@@ -0,0 +1,36 @@\
+# Brkthru RFP Analyzer \'97 Backend scaffold\
+\
+Quick setup (local)\
+\
+1. Copy `.env.example` -> `.env` and fill values (DO NOT commit `.env`):\
+   ```bash\
+   cp .env.example .env\
+   # edit .env and add secrets\
+   ```\
+\
+2. Install & run:\
+   ```bash\
+   npm install\
+   npm start\
+   ```\
+\
+3. Frontend:\
+   - Serve your patched frontend (`index.html`) from `FRONTEND_ORIGIN` (default http://localhost:3000).\
+   - Flow: user clicks Connect -> Google returns code -> frontend posts `/auth/exchange` -> server stores tokens in session.\
+   - Frontend posts RFP to `/api/ai/analyze` and posts analysis to `/api/slides/create` to build presentation.\
+\
+Security notes:\
+ - Rotate any Google client secrets previously exposed in the frontend.\
+ - Use HTTPS and a production session store (Redis) for production.\
+ - Do NOT store secrets in the repository.\
diff --git a/.gitignore b/.gitignore\
new file mode 100644\
index 0000000..d3e3f4a\
--- /dev/null\
+++ b/.gitignore\
@@ -0,0 +1,8 @@\
+# Node\
+node_modules/\
+\
+# Env\
+.env\
+\
+# Logs\
+npm-debug.log*\
diff --git a/index.patched.html b/index.patched.html\
new file mode 100644\
index 0000000..e5b7a3d\
--- /dev/null\
+++ b/index.patched.html\
@@ -0,0 +1,469 @@\
+<!DOCTYPE html>\
+<html lang="en">\
+<head>\
+    <meta charset="UTF-8" />\
+    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>\
+    <title>Brkthru RFP Analyzer</title>\
+    <script src="https://cdn.tailwindcss.com"></script>\
+    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>\
+</head>\
+<body class="bg-gradient-to-br from-orange-50 to-slate-100 min-h-screen p-8">\
+    <div id="app" class="max-w-5xl mx-auto"></div>\
+\
+    <script>\
+        const CONFIG = \{\
+            google: \{\
+                clientId: '1084111592719-99dj0bctr8vhrjuensgkdr0s70t0kptg.apps.googleusercontent.com',\
+                redirectUri: window.location.origin + window.location.pathname,\
+                scope: 'https://www.googleapis.com/auth/presentations https://www.googleapis.com/auth/drive.file'\
+            \},\
+            brkthru: \{\
+                capabilities: 'Premium CTV, Display, Video, Audio, Social, SEM, DOOH. Tech-agnostic approach.',\
+                differentiators: ['No minimums', 'White-glove service', '90% satisfaction', '235+ clients'],\
+                approach: \{\
+                    awareness: 'CTV, Display, Video, Audio, Social',\
+                    consideration: 'Display, YouTube, Native, Social, SEM',\
+                    conversion: 'Retargeting, SEM, Social'\
+                \}\
+            \}\
+        \};\
+\
+        let state = \{\
+            authenticated: false,\
+            file: null,\
+            pastedText: '',\
+            inputMode: 'file',\
+            status: 'idle',\
+            progress: '',\
+            generatedContent: null,\
+            slidesDeckUrl: null\
+        \};\
+\
+        function escapeHtml(str) \{\
+            if (str === null || str === undefined) return '';\
+            return String(str)\
+                .replaceAll('&', '&amp;')\
+                .replaceAll('<', '&lt;')\
+                .replaceAll('>', '&gt;')\
+                .replaceAll('"', '&quot;')\
+                .replaceAll("'", '&#39;');\
+        \}\
+\
+        window.addEventListener('DOMContentLoaded', async () => \{\
+            const params = new URLSearchParams(window.location.search);\
+            const code = params.get('code');\
+            if (code) \{\
+                await exchangeCodeForToken(code);\
+                window.history.replaceState(\{\}, document.title, window.location.pathname);\
+            \}\
+            await checkAuthStatus();\
+            render();\
+        \});\
+\
+        function authenticateGoogle() \{\
+            const authUrl =\
+                `https://accounts.google.com/o/oauth2/v2/auth?` +\
+                `client_id=$\{encodeURIComponent(CONFIG.google.clientId)\}&` +\
+                `redirect_uri=$\{encodeURIComponent(CONFIG.google.redirectUri)\}&` +\
+                `response_type=code&` +\
+                `scope=$\{encodeURIComponent(CONFIG.google.scope)\}&` +\
+                `access_type=offline&` +\
+                `prompt=consent`;\
+            window.location.href = authUrl;\
+        \}\
+\
+        async function exchangeCodeForToken(code) \{\
+            updateProgress('Exchanging authorization code securely...', 'processing');\
+            try \{\
+                const resp = await fetch('/auth/exchange', \{\
+                    method: 'POST',\
+                    headers: \{ 'Content-Type': 'application/json' \},\
+                    credentials: 'include',\
+                    body: JSON.stringify(\{ code, redirectUri: CONFIG.google.redirectUri \})\
+                \});\
+                const data = await resp.json();\
+                if (!resp.ok) throw new Error(data.error || JSON.stringify(data));\
+                updateProgress('\uc0\u10003  Authenticated (server-side)', 'complete');\
+                await checkAuthStatus();\
+            \} catch (err) \{\
+                updateProgress(`Authentication error: $\{err.message\}`, 'error');\
+            \}\
+        \}\
+\
+        async function checkAuthStatus() \{\
+            try \{\
+                const resp = await fetch('/auth/status', \{ credentials: 'include' \});\
+                if (!resp.ok) \{\
+                    state.authenticated = false;\
+                \} else \{\
+                    const j = await resp.json();\
+                    state.authenticated = !!j.authenticated;\
+                \}\
+            \} catch (e) \{\
+                state.authenticated = false;\
+            \}\
+            render();\
+        \}\
+\
+        function disconnect() \{\
+            state.authenticated = false;\
+            state.generatedContent = null;\
+            state.slidesDeckUrl = null;\
+            render();\
+        \}\
+\
+        function switchInputMode(mode) \{\
+            state.inputMode = mode;\
+            state.file = null;\
+            state.pastedText = '';\
+            state.generatedContent = null;\
+            state.slidesDeckUrl = null;\
+            render();\
+        \}\
+\
+        function handleFileUpload(event) \{\
+            state.file = event.target.files[0];\
+            state.status = 'ready';\
+            render();\
+        \}\
+\
+        function handleTextPaste(event) \{\
+            state.pastedText = event.target.value;\
+            state.status = state.pastedText.trim() ? 'ready' : 'idle';\
+        \}\
+\
+        async function analyzeRFP() \{\
+            if (!state.authenticated) \{\
+                alert('Please connect to Google first!');\
+                return;\
+            \}\
+\
+            const hasInput = state.inputMode === 'file' ? state.file : state.pastedText.trim();\
+            if (!hasInput) \{\
+                alert('Please upload a file or paste RFP text first!');\
+                return;\
+            \}\
+\
+            updateProgress('Reading RFP content...', 'processing');\
+\
+            try \{\
+                const rfpText = state.inputMode === 'file' ? await readFile(state.file) : state.pastedText;\
+\
+                updateProgress('Analyzing RFP with LLM (server-side)...', 'processing');\
+                const analysis = await callClaudeAPI(rfpText);\
+\
+                state.generatedContent = analysis;\
+                render();\
+\
+                updateProgress('Creating Google Slides presentation (server-side)...', 'processing');\
+                const deckUrl = await createGoogleSlides(analysis);\
+\
+                state.slidesDeckUrl = deckUrl;\
+                updateProgress('\uc0\u9989  Complete! Your presentation is ready.', 'complete');\
+                render();\
+\
+            \} catch (error) \{\
+                updateProgress(`Error: $\{error.message\}`, 'error');\
+            \}\
+        \}\
+\
+        async function readFile(file) \{\
+            return new Promise((resolve, reject) => \{\
+                if (!file) return reject(new Error('No file provided'));\
+                const fileName = file.name.toLowerCase();\
+\
+                if (fileName.endsWith('.docx')) \{\
+                    const reader = new FileReader();\
+                    reader.onload = async (e) => \{\
+                        try \{\
+                            const arrayBuffer = e.target.result;\
+                            const result = await mammoth.extractRawText(\{ arrayBuffer \});\
+                            resolve(result.value);\
+                        \} catch (error) \{\
+                            reject(new Error('Failed to read Word document: ' + error.message));\
+                        \}\
+                    \};\
+                    reader.onerror = () => reject(new Error('Failed to read file'));\
+                    reader.readAsArrayBuffer(file);\
+                \} else \{\
+                    const reader = new FileReader();\
+                    reader.onload = (e) => resolve(e.target.result);\
+                    reader.onerror = () => reject(new Error('Failed to read file'));\
+                    reader.readAsText(file);\
+                \}\
+            \});\
+        \}\
+\
+        async function callClaudeAPI(rfpContent) \{\
+            const resp = await fetch('/api/ai/analyze', \{\
+                method: 'POST',\
+                headers: \{ 'Content-Type': 'application/json' \},\
+                credentials: 'include',\
+                body: JSON.stringify(\{ rfp: rfpContent \})\
+            \});\
+            if (!resp.ok) \{\
+                const t = await resp.text();\
+                throw new Error('AI analyze failed: ' + t);\
+            \}\
+            const j = await resp.json();\
+            if (!j.analysis) throw new Error('Invalid AI response');\
+            return j.analysis;\
+        \}\
+\
+        async function createGoogleSlides(content) \{\
+            const resp = await fetch('/api/slides/create', \{\
+                method: 'POST',\
+                headers: \{ 'Content-Type': 'application/json' \},\
+                credentials: 'include',\
+                body: JSON.stringify(\{ content \})\
+            \});\
+            if (!resp.ok) \{\
+                const t = await resp.text();\
+                throw new Error('Slides creation failed: ' + t);\
+            \}\
+            const j = await resp.json();\
+            return j.url;\
+        \}\
+\
+        function updateProgress(message, status) \{\
+            state.progress = message;\
+            state.status = status;\
+            render();\
+        \}\
+\
+        function render() \{\
+            const app = document.getElementById('app');\
+            const isAuthenticated = !!state.authenticated;\
+\
+            const fileLabel = state.file ? escapeHtml(state.file.name) : 'Click to browse or drag file here';\
+            const pastedTextEscaped = escapeHtml(state.pastedText);\
+\
+            const gen = state.generatedContent || \{\};\
+            const clientName = escapeHtml(gen.clientName || 'Client');\
+            const totalBudget = escapeHtml(gen.investment?.totalBudget || '');\
+            const channelsList = Array.isArray(gen.strategy?.recommendedChannels) ? gen.strategy.recommendedChannels.map(escapeHtml).join(', ') : '';\
+            const insightsCount = Array.isArray(gen.research?.insights) ? gen.research.insights.length : 0;\
+\
+            app.innerHTML = `\
+                <div class="text-center mb-8">\
+                    <div class="inline-flex items-center gap-3 mb-4">\
+                        <svg class="w-12 h-12 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">\
+                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>\
+                        </svg>\
+                        <h1 class="text-5xl font-bold text-slate-900">Brkthru RFP Analyzer</h1>\
+                    </div>\
+                    <p class="text-slate-600 text-xl">Upload RFP \uc0\u8594  AI Strategy \u8594  Auto-Generated Slides</p>\
+                </div>\
+\
+                <div class="mb-6">\
+                    $\{isAuthenticated ? `\
+                        <div class="bg-green-50 border border-green-200 rounded-lg p-4 flex items-center justify-between">\
+                            <div class="flex items-center gap-3">\
+                                <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">\
+                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>\
+                                </svg>\
+                                <span class="text-green-800 font-medium">Connected to Google Slides</span>\
+                            </div>\
+                            <button onclick="disconnect()" class="text-sm text-green-700 hover:text-green-900 underline">\
+                                Disconnect\
+                            </button>\
+                        </div>\
+                    ` : `\
+                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">\
+                            <div class="flex items-start gap-4">\
+                                <svg class="w-6 h-6 text-blue-600 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">\
+                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>\
+                                </svg>\
+                                <div class="flex-1">\
+                                    <h3 class="font-semibold text-blue-900 mb-2">Connect to Google Slides</h3>\
+                                    <p class="text-blue-800 mb-4 text-sm">Authorize access to create presentations in your Google account (handled server-side).</p>\
+                                    <button onclick="authenticateGoogle()" class="px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700">\
+                                        Connect Google Account\
+                                    </button>\
+                                </div>\
+                            </div>\
+                        </div>\
+                    `\}\
+                </div>\
+\
+                <div class="bg-white rounded-2xl shadow-xl p-8">\
+                    <div class="flex gap-2 mb-6 border-b-2 border-slate-200">\
+                        <button \
+                            onclick="switchInputMode('file')" \
+                            class="px-6 py-3 font-semibold rounded-t-lg transition-colors $\{state.inputMode === 'file' ? 'bg-orange-500 text-white border-b-2 border-orange-500 -mb-0.5' : 'text-slate-600 hover:bg-slate-100'\}">\
+                            \uc0\u55357 \u56526  Upload File\
+                        </button>\
+                        <button \
+                            onclick="switchInputMode('paste')" \
+                            class="px-6 py-3 font-semibold rounded-t-lg transition-colors $\{state.inputMode === 'paste' ? 'bg-orange-500 text-white border-b-2 border-orange-500 -mb-0.5' : 'text-slate-600 hover:bg-slate-100'\}">\
+                            \uc0\u55357 \u56541  Paste Text\
+                        </button>\
+                    </div>\
+\
+                    $\{state.inputMode === 'file' ? `\
+                        <label class="block cursor-pointer mb-6">\
+                            <div class="border-2 border-dashed border-slate-300 rounded-xl p-12 text-center hover:border-orange-400 transition-colors">\
+                                <input type="file" onchange="handleFileUpload(event)" accept=".docx,.txt" class="hidden"/>\
+                                <svg class="w-12 h-12 mx-auto mb-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">\
+                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>\
+                                </svg>\
+                                <p class="text-lg font-medium text-slate-700 mb-2">\
+                                    $\{fileLabel\}\
+                                </p>\
+                                <p class="text-sm text-slate-500">Word (.docx) or Text (.txt) files</p>\
+                            </div>\
+                        </label>\
+                    ` : `\
+                        <div class="mb-6">\
+                            <label class="block mb-2 text-sm font-medium text-slate-700">\
+                                Paste your RFP content below:\
+                            </label>\
+                            <textarea \
+                                oninput="handleTextPaste(event)"\
+                                placeholder="Paste RFP text here..."\
+                                class="w-full h-64 p-4 border-2 border-slate-300 rounded-lg focus:border-orange-400 focus:outline-none resize-none font-mono text-sm"\
+                            >$\{pastedTextEscaped\}</textarea>\
+                            <p class="mt-2 text-xs text-slate-500">\
+                                \uc0\u55357 \u56481  Tip: Copy from email, Word doc, or anywhere and paste here\
+                            </p>\
+                        </div>\
+                    `\}\
+\
+                    $\{(state.file || state.pastedText.trim()) ? `\
+                        <button \
+                            onclick="analyzeRFP()" \
+                            $\{state.status === 'processing' || !isAuthenticated ? 'disabled' : ''\}\
+                            class="w-full mb-6 px-6 py-4 bg-orange-500 text-white rounded-lg font-bold hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-lg transition-colors flex items-center justify-center gap-2">\
+                            $\{state.status === 'processing' ? `\
+                                <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\
+                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\
+                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\
+                                </svg>\
+                                Processing...\
+                            ` : `\
+                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">\
+                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>\
+                                </svg>\
+                                Generate Slides\
+                            `\}\
+                        </button>\
+                    ` : ''\}\
+\
+                    $\{state.progress ? `\
+                        <div class="p-4 rounded-lg mb-6 flex items-center gap-3 $\{state.status === 'error' ? 'bg-red-50 border border-red-200 text-red-700' : state.status === 'complete' ? 'bg-green-50 border border-green-200 text-green-700' : 'bg-blue-50 border border-blue-200 text-blue-700'\}">\
+                            $\{state.status === 'processing' ? `\
+                                <svg class="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\
+                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\
+                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\
+                                </svg>\
+                            ` : ''\}\
+                            <span class="font-medium">$\{escapeHtml(state.progress)\}</span>\
+                        </div>\
+                    ` : ''\}\
+\
+                    $\{state.generatedContent ? `\
+                        <div class="space-y-4 mb-6">\
+                            <div class="bg-gradient-to-r from-orange-500 to-orange-600 text-white p-6 rounded-xl">\
+                                <h2 class="text-2xl font-bold mb-2">\
+                                    $\{clientName\} - Strategic Proposal\
+                                </h2>\
+                                <p class="text-orange-100">\
+                                    3 slides generated \'95 Budget: $\{escapeHtml(totalBudget)\}\
+                                </p>\
+                            </div>\
+\
+                            <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded-r-lg">\
+                                <h3 class="text-lg font-bold text-orange-900 mb-2">\uc0\u55357 \u56522  Slide 5: Strategy</h3>\
+                                <p class="text-sm text-slate-700">\
+                                    <strong>Channels:</strong> $\{channelsList\}\
+                                </p>\
+                            </div>\
+\
+                            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg">\
+                                <h3 class="text-lg font-bold text-blue-900 mb-2">\uc0\u55357 \u56496  Slide 6: Investment</h3>\
+                                <p class="text-sm text-slate-700">\
+                                    <strong>Budget:</strong> $\{escapeHtml(totalBudget)\}\
+                                </p>\
+                            </div>\
+\
+                            <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded-r-lg">\
+                                <h3 class="text-lg font-bold text-green-900 mb-2">\uc0\u55357 \u56589  Slide 7: Research</h3>\
+                                <p class="text-sm text-slate-700">\
+                                    $\{insightsCount\} industry insights generated\
+                                </p>\
+                            </div>\
+                        </div>\
+                    ` : ''\}\
+\
+                    $\{state.slidesDeckUrl ? `\
+                        <a \
+                            href="$\{escapeHtml(state.slidesDeckUrl)\}" \
+                            target="_blank" \
+                            rel="noopener noreferrer"\
+                            class="block w-full py-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl font-bold text-center text-lg hover:from-green-600 hover:to-green-700 shadow-lg transition-all">\
+                            Open Your Presentation in Google Slides \uc0\u8594 \
+                        </a>\
+                    ` : ''\}\
+                </div>\
+\
+                <div class="mt-8 text-center text-sm text-slate-500">\
+                    <p>\uc0\u55357 \u56594  Secure \'95 OAuth & LLM calls are proxied through the server \'95 No secrets in the browser</p>\
+                </div>\
+            `;\
+        \}\
+    </script>\
+</body>\
+</html>}