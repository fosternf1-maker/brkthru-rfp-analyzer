<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2487.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1">&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1">&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1">&lt;title&gt;Brkthru RFP Analyzer&lt;/title&gt;</span></p>
<p class="p1"><span class="s1">&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body class="bg-gradient-to-br from-orange-50 to-slate-100 min-h-screen p-8"&gt;</span></p>
<p class="p1"><span class="s1">&lt;div id="app" class="max-w-5xl mx-auto"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;script&gt;</span></p>
<p class="p1"><span class="s1">const C={google:{clientId:'1084111592719-99dj0bctr8vhrjuensgkdr0s70t0kptg.apps.googleusercontent.com',clientSecret:'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',redirectUri:'https://fosternf1-maker.github.io/brkthru-rfp-analyzer/',scope:'https://www.googleapis.com/auth/presentations https://www.googleapis.com/auth/drive.file',templateId:'1G3YGavHm6fJdCMaLnlRllOlQvisC9Blo'},brkthru:{cap:'Custom built for scale in mid market. Premium CTV, Display, Video, Audio, Social, SEM, DOOH. Tech-agnostic approach.',diff:['No minimums','White-glove service','90% satisfaction','235+ clients','Tech-agnostic'],approach:{awareness:'CTV, Display, Video, Audio, Social',consideration:'Display, YouTube, Native, Social, SEM',conversion:'Retargeting, SEM, Social'}}};</span></p>
<p class="p1"><span class="s1">let S={token:null,file:null,status:'idle',msg:'',content:null,url:null};</span></p>
<p class="p1"><span class="s1">window.onload=()=&gt;{const t=localStorage.getItem('brkthru_token');if(t){const d=JSON.parse(t);if(d.expiry&gt;Date.now())S.token=d.token;else localStorage.removeItem('brkthru_token');}const p=new URLSearchParams(location.search),c=p.get('code');c?getToken(c):render();};</span></p>
<p class="p1"><span class="s1">function auth(){location.href=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${C.google.clientId}&amp;redirect_uri=${encodeURIComponent(C.google.redirectUri)}&amp;response_type=code&amp;scope=${encodeURIComponent(C.google.scope)}&amp;access_type=offline&amp;prompt=consent`;}</span></p>
<p class="p1"><span class="s1">async function getToken(code){update('Authenticating...','proc');try{const r=await fetch('https://oauth2.googleapis.com/token',{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded'},body:new URLSearchParams({code,client_id:C.google.clientId,client_secret:C.google.clientSecret,redirect_uri:C.google.redirectUri,grant_type:'authorization_code'})});const d=await r.json();if(d.access_token){const t={token:d.access_token,expiry:Date.now()+(d.expires_in*1000)};localStorage.setItem('brkthru_token',JSON.stringify(t));S.token=d.access_token;update('‚úì Authenticated','done');history.replaceState({},document.title,location.pathname);setTimeout(render,1000);}}catch(e){update('Auth error: '+e.message,'err');}}</span></p>
<p class="p1"><span class="s1">function disc(){localStorage.removeItem('brkthru_token');S.token=null;render();}</span></p>
<p class="p1"><span class="s1">function upload(e){S.file=e.target.files[0];S.status='ready';render();}</span></p>
<p class="p1"><span class="s1">async function analyze(){if(!S.file||!S.token){alert('Connect Google &amp; upload file first');return;}update('Reading file...','proc');try{const txt=await readFile(S.file);update('Analyzing with Claude...','proc');const res=await callClaude(txt);S.content=res;render();update('Creating slides...','proc');const url=await makeSlides(res);S.url=url;update('‚úì Done!','done');render();}catch(e){update('Error: '+e.message,'err');}}</span></p>
<p class="p1"><span class="s1">async function readFile(f){return new Promise((ok,err)=&gt;{const n=f.name.toLowerCase();if(n.endsWith('.docx')){const r=new FileReader();r.onload=async(e)=&gt;{try{const ab=e.target.result;const res=await mammoth.extractRawText({arrayBuffer:ab});ok(res.value);}catch(ex){err(new Error('Word read failed: '+ex.message));}};r.onerror=()=&gt;err(new Error('Read failed'));r.readAsArrayBuffer(f);}else{const r=new FileReader();r.onload=(e)=&gt;ok(e.target.result);r.onerror=()=&gt;err(new Error('Read failed'));r.readAsText(f);}});}</span></p>
<p class="p1"><span class="s1">async function callClaude(txt){const sys=`You are a Brkthru strategist. Company: ${JSON.stringify(C.brkthru)}. Generate JSON with 3 slides:</span></p>
<p class="p1"><span class="s1">1. Strategy: {goals:[],targetAudience:"",geographicTarget:"",recommendedChannels:[],narrative:"2-3 paragraphs",targetingApproach:""}</span></p>
<p class="p1"><span class="s1">2. Investment: {totalBudget:"",flightDates:"",mediaAllocation:[{channel:"",percentage:0,budget:"",rationale:"",kpis:""}],pixelStrategy:""}</span></p>
<p class="p1"><span class="s1">3. Research: {insights:[{title:"",finding:"",source:"",relevance:""}]}</span></p>
<p class="p1"><span class="s1">Output: {clientName:"",strategy:{...},investment:{...},research:{...}}`;</span></p>
<p class="p1"><span class="s1">const r=await fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json','anthropic-version':'2023-06-01'},body:JSON.stringify({model:'claude-sonnet-4-20250514',max_tokens:4096,system:sys,messages:[{role:'user',content:'Analyze RFP:\n'+txt}]})});</span></p>
<p class="p1"><span class="s1">if(!r.ok)throw new Error('Claude API: '+r.status);</span></p>
<p class="p1"><span class="s1">const d=await r.json();const c=d.content[0].text;const m=c.match(/\{[\s\S]*\}/);if(!m)throw new Error('Parse failed');return JSON.parse(m[0]);}</span></p>
<p class="p1"><span class="s1">async function makeSlides(c){update('Copying template...','proc');const cr=await fetch(`https://www.googleapis.com/drive/v3/files/${C.google.templateId}/copy`,{method:'POST',headers:{Authorization:`Bearer ${S.token}`,'Content-Type':'application/json'},body:JSON.stringify({name:`${c.clientName||'Client'} - RFP - ${new Date().toLocaleDateString()}`})});const nd=await cr.json();if(!nd.id)throw new Error('Copy failed');const id=nd.id;</span></p>
<p class="p1"><span class="s1">update('Adding slides...','proc');await fetch(`https://slides.googleapis.com/v1/presentations/${id}:batchUpdate`,{method:'POST',headers:{Authorization:`Bearer ${S.token}`,'Content-Type':'application/json'},body:JSON.stringify({requests:[{createSlide:{insertionIndex:5,slideLayoutReference:{predefinedLayout:'TITLE_AND_BODY'}}},{createSlide:{insertionIndex:6,slideLayoutReference:{predefinedLayout:'TITLE_AND_BODY'}}},{createSlide:{insertionIndex:7,slideLayoutReference:{predefinedLayout:'TITLE_AND_BODY'}}}]})});</span></p>
<p class="p1"><span class="s1">update('Adding content...','proc');const ur=await fetch(`https://slides.googleapis.com/v1/presentations/${id}`,{headers:{Authorization:`Bearer ${S.token}`}});const u=await ur.json();const sids=u.slides.slice(5,8).map(s=&gt;s.objectId);const reqs=[];</span></p>
<p class="p1"><span class="s1">for(let i=0;i&lt;3;i++){const sl=u.slides.find(s=&gt;s.objectId===sids[i]);const tb=sl.pageElements.filter(e=&gt;e.shape&amp;&amp;e.shape.shapeType==='TEXT_BOX');if(tb.length&gt;=2){let t='',b='';if(i===0){t='üìä Strategy';b=`Goals: ${c.strategy.goals.join(', ')}\nTarget: ${c.strategy.targetAudience}\nChannels: ${c.strategy.recommendedChannels.join(', ')}\n\n${c.strategy.narrative}`;}else if(i===1){t='üí∞ Investment';b=`${c.investment.totalBudget} | ${c.investment.flightDates}\n\n`+c.investment.mediaAllocation.map(m=&gt;`${m.channel} - ${m.percentage}% (${m.budget})\n${m.rationale}`).join('\n\n');}else{t='üîç Research';b=c.research.insights.map(ins=&gt;`${ins.title}\n${ins.finding}\n${ins.source}`).join('\n\n');}</span></p>
<p class="p1"><span class="s1">reqs.push({insertText:{objectId:tb[0].objectId,text:t,insertionIndex:0}},{insertText:{objectId:tb[1].objectId,text:b,insertionIndex:0}});}}</span></p>
<p class="p1"><span class="s1">await fetch(`https://slides.googleapis.com/v1/presentations/${id}:batchUpdate`,{method:'POST',headers:{Authorization:`Bearer ${S.token}`,'Content-Type':'application/json'},body:JSON.stringify({requests:reqs})});return `https://docs.google.com/presentation/d/${id}/edit`;}</span></p>
<p class="p1"><span class="s1">function update(m,st){S.msg=m;S.status=st;render();}</span></p>
<p class="p1"><span class="s1">function render(){const a=document.getElementById('app');const ok=!!S.token;a.innerHTML=`&lt;div class="text-center mb-8"&gt;&lt;h1 class="text-5xl font-bold text-slate-900 mb-2"&gt;‚ö° Brkthru RFP Analyzer&lt;/h1&gt;&lt;p class="text-slate-600 text-lg"&gt;Upload RFP ‚Üí AI Strategy ‚Üí Auto Slides&lt;/p&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;div class="mb-6"&gt;${ok?`&lt;div class="bg-green-50 border border-green-200 rounded-lg p-4 flex justify-between items-center"&gt;&lt;span class="text-green-800 font-medium"&gt;‚úì Connected&lt;/span&gt;&lt;button onclick="disc()" class="text-sm text-green-700 underline"&gt;Disconnect&lt;/button&gt;&lt;/div&gt;`:`&lt;div class="bg-blue-50 border border-blue-200 rounded-lg p-6"&gt;&lt;h3 class="font-bold text-blue-900 mb-2"&gt;Connect Google&lt;/h3&gt;&lt;button onclick="auth()" class="px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700"&gt;Connect&lt;/button&gt;&lt;/div&gt;`}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;div class="bg-white rounded-2xl shadow-xl p-8"&gt;&lt;label class="block cursor-pointer mb-6"&gt;&lt;div class="border-2 border-dashed border-slate-300 rounded-xl p-12 text-center hover:border-orange-400"&gt;&lt;input type="file" onchange="upload(event)" accept=".docx,.txt" class="hidden"/&gt;&lt;svg class="w-12 h-12 mx-auto mb-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/&gt;&lt;/svg&gt;&lt;p class="text-lg font-medium"&gt;${S.file?S.file.name:'Drop RFP or click'}&lt;/p&gt;&lt;p class="text-sm text-slate-500"&gt;Word (.docx) or Text (.txt)&lt;/p&gt;&lt;/div&gt;&lt;/label&gt;</span></p>
<p class="p1"><span class="s1">${S.file?`&lt;button onclick="analyze()" ${S.status==='proc'||!ok?'disabled':''} class="w-full mb-6 px-6 py-4 bg-orange-500 text-white rounded-lg font-bold hover:bg-orange-600 disabled:opacity-50 text-lg"&gt;${S.status==='proc'?'‚è≥ Processing...':'‚ö° Generate Slides'}&lt;/button&gt;`:''}</span></p>
<p class="p1"><span class="s1">${S.msg?`&lt;div class="p-4 rounded-lg mb-6 ${S.status==='err'?'bg-red-50 text-red-700':S.status==='done'?'bg-green-50 text-green-700':'bg-blue-50 text-blue-700'}"&gt;&lt;span class="font-medium"&gt;${S.msg}&lt;/span&gt;&lt;/div&gt;`:''}</span></p>
<p class="p1"><span class="s1">${S.content?`&lt;div class="space-y-4 mb-6"&gt;&lt;div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded-r"&gt;&lt;strong&gt;üìä Strategy:&lt;/strong&gt; ${S.content.strategy.recommendedChannels.join(', ')}&lt;/div&gt;&lt;div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r"&gt;&lt;strong&gt;üí∞ Investment:&lt;/strong&gt; ${S.content.investment.totalBudget}&lt;/div&gt;&lt;div class="bg-green-50 border-l-4 border-green-500 p-4 rounded-r"&gt;&lt;strong&gt;üîç Research:&lt;/strong&gt; ${S.content.research.insights.length} insights&lt;/div&gt;&lt;/div&gt;`:''}</span></p>
<p class="p1"><span class="s1">${S.url?`&lt;a href="${S.url}" target="_blank" class="block w-full py-4 bg-green-600 text-white rounded-xl font-bold text-center text-lg hover:bg-green-700"&gt;Open Slides ‚Üí&lt;/a&gt;`:''}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;div class="mt-8 text-center text-sm text-slate-500"&gt;&lt;p&gt;üîí Secure ‚Ä¢ Claude AI + Google Slides API&lt;/p&gt;&lt;/div&gt;`;}</span></p>
<p class="p1"><span class="s1">&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
